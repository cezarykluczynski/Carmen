checkstyle {
    configFile = new File("checkstyle.xml")
    toolVersion = "7.1.1"
}

test {
    jacoco {
        append = false
        destinationFile = file("$buildDir/jacoco/jacocoTest.exec")
        classDumpFile = file("$buildDir/jacoco/classpathdumps")
    }

    testLogging {
        events "passed", "skipped", "failed", "standardOut", "standardError"
    }

    testLogging.showStandardStreams = true

    minHeapSize = "64m"
    maxHeapSize = "256m"
    jvmArgs '-XX:MaxPermSize=256m'

    finalizedBy jacocoTestReport
}

jacoco {
    toolVersion = "0.7.7.201606060606"
    reportsDir = file("$buildDir/reports/jacoco")
}

jacocoTestReport {
    reports {
        xml.enabled true
        csv.enabled false
        html.destination "${buildDir}/reports/jacoco/html"
    }
    afterEvaluate {
        classDirectories = files(classDirectories.files.collect {
            fileTree(dir: it, exclude: 'com/cezarykluczynski/carmen/db/**')
        })
    }
}